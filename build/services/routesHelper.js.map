{"version":3,"sources":["../../src/services/routesHelper.js"],"names":["allowOnly","accessLevel","callback","checkUserRole","req","res","role","user","dataValues","console","log","status","json","msg","module","exports"],"mappings":";;AAAA,IAAMA,YAAY,SAAZA,SAAY,CAAUC,WAAV,EAAuBC,QAAvB,EAAiC;AAC/C,aAASC,aAAT,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiC;AAAA,YACrBC,IADqB,GACZF,IAAIG,IAAJ,CAAS,CAAT,EAAYC,UADA,CACrBF,IADqB;;AAE7BG,gBAAQC,GAAR,CAAYT,WAAZ;AACAQ,gBAAQC,GAAR,CAAY,EAAEJ,UAAF,EAAQL,wBAAR,EAAZ;AACA,YAAI,EAAEA,cAAcK,IAAhB,CAAJ,EAA2B;AACvBD,gBAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,KAAK,gCAAP,EAArB;AACA;AACH;;AAEDX,iBAASE,GAAT,EAAcC,GAAd;AACH;;AAED,WAAOF,aAAP;AACH,CAdD;;AAgBAW,OAAOC,OAAP,GAAiB,EAAEf,oBAAF,EAAjB","file":"routesHelper.js","sourcesContent":["const allowOnly = function (accessLevel, callback) {\n    function checkUserRole(req, res) {\n        const { role } = req.user[0].dataValues;\n        console.log(accessLevel)\n        console.log({ role, accessLevel })\n        if (!(accessLevel & role)) {\n            res.status(403).json({ msg: 'You do not have access to this' })\n            return;\n        }\n\n        callback(req, res)\n    }\n\n    return checkUserRole;\n}\n\nmodule.exports = { allowOnly }"]}