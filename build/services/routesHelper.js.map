{"version":3,"file":"routesHelper.js","names":["allowOnly","accessLevel","callback","checkUserRole","req","res","role","user","dataValues","console","log","status","json","msg","module","exports"],"sources":["../../src/services/routesHelper.js"],"sourcesContent":["const allowOnly = function (accessLevel, callback) {\n    function checkUserRole(req, res) {\n        const { role } = req.user[0].dataValues;\n        console.log(accessLevel)\n        console.log({ role, accessLevel })\n        if (!(accessLevel & role)) {\n            res.status(403).json({ msg: 'You do not have access to this' })\n            return;\n        }\n\n        callback(req, res)\n    }\n\n    return checkUserRole;\n}\n\nmodule.exports = { allowOnly }"],"mappings":";;AAAA,IAAMA,SAAS,GAAG,SAAZA,SAASA,CAAaC,WAAW,EAAEC,QAAQ,EAAE;EAC/C,SAASC,aAAaA,CAACC,GAAG,EAAEC,GAAG,EAAE;IAC7B,IAAQC,IAAI,GAAKF,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC,CAACC,UAAU,CAA/BF,IAAI;IACZG,OAAO,CAACC,GAAG,CAACT,WAAW,CAAC;IACxBQ,OAAO,CAACC,GAAG,CAAC;MAAEJ,IAAI,EAAJA,IAAI;MAAEL,WAAW,EAAXA;IAAY,CAAC,CAAC;IAClC,IAAI,EAAEA,WAAW,GAAGK,IAAI,CAAC,EAAE;MACvBD,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,GAAG,EAAE;MAAiC,CAAC,CAAC;MAC/D;IACJ;IAEAX,QAAQ,CAACE,GAAG,EAAEC,GAAG,CAAC;EACtB;EAEA,OAAOF,aAAa;AACxB,CAAC;AAEDW,MAAM,CAACC,OAAO,GAAG;EAAEf,SAAS,EAATA;AAAU,CAAC","ignoreList":[]}