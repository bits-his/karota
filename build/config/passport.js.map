{"version":3,"sources":["../../src/config/passport.js"],"names":["require","ExtractJwt","JwtStrategy","Strategy","models","config","Users","User","opts","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","process","env","JWT_SECRET_KEY","module","exports","passport","use","jwt_payload","done","findAll","where","id","then","user","length","catch","console","log","err"],"mappings":";;eAAuBA,QAAQ,cAAR,C;IAAfC,U,YAAAA,U;;AACR,IAAMC,cAAcF,QAAQ,cAAR,EAAwBG,QAA5C;AACA,IAAMC,SAASJ,QAAQ,WAAR,CAAf;AACAA,QAAQ,QAAR,EAAkBK,MAAlB;;AAEA,IAAMC,QAAQF,OAAOG,IAArB;;AAEA,IAAMC,OAAO,EAAb;AACAA,KAAKC,cAAL,GAAsBR,WAAWS,2BAAX,EAAtB;AACAF,KAAKG,WAAL,GAAmBC,QAAQC,GAAR,CAAYC,cAA/B;;AAEAC,OAAOC,OAAP,GAAiB,oBAAY;AAC3BC,WAASC,GAAT,CACE,IAAIhB,WAAJ,CAAgBM,IAAhB,EAAsB,UAACW,WAAD,EAAcC,IAAd,EAAuB;AAC3Cd,UAAMe,OAAN,CAAc,EAAEC,OAAO,EAAEC,IAAIJ,YAAYI,EAAlB,EAAT,EAAd,EACGC,IADH,CACQ,gBAAQ;AACZ,UAAIC,KAAKC,MAAT,EAAiB;AACf,eAAON,KAAK,IAAL,EAAWK,IAAX,CAAP;AACD;AACD,aAAOL,KAAK,IAAL,EAAW,KAAX,CAAP;AACD,KANH,EAOGO,KAPH,CAOS;AAAA,aAAOC,QAAQC,GAAR,CAAYC,GAAZ,CAAP;AAAA,KAPT;AAQD,GATD,CADF;AAYD,CAbD","file":"passport.js","sourcesContent":["const { ExtractJwt } = require('passport-jwt')\nconst JwtStrategy = require('passport-jwt').Strategy\nconst models = require('../models')\nrequire('dotenv').config();\n\nconst Users = models.User;\n\nconst opts = {};\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\nopts.secretOrKey = process.env.JWT_SECRET_KEY;\n\nmodule.exports = passport => {\n  passport.use(\n    new JwtStrategy(opts, (jwt_payload, done) => {\n      Users.findAll({ where: { id: jwt_payload.id } })\n        .then(user => {\n          if (user.length) {\n            return done(null, user);\n          }\n          return done(null, false);\n        })\n        .catch(err => console.log(err));\n    })\n  );\n};\n"]}