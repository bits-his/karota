{"version":3,"file":"passport.js","names":["_require","require","ExtractJwt","JwtStrategy","Strategy","models","config","Users","User","opts","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","process","env","JWT_SECRET_KEY","module","exports","passport","use","jwt_payload","done","findAll","where","id","then","user","length","err","console","log"],"sources":["../../src/config/passport.js"],"sourcesContent":["const { ExtractJwt } = require('passport-jwt')\nconst JwtStrategy = require('passport-jwt').Strategy\nconst models = require('../models')\nrequire('dotenv').config();\n\nconst Users = models.User;\n\nconst opts = {};\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\nopts.secretOrKey = process.env.JWT_SECRET_KEY;\n\nmodule.exports = passport => {\n  passport.use(\n    new JwtStrategy(opts, (jwt_payload, done) => {\n      Users.findAll({ where: { id: jwt_payload.id } })\n        .then(user => {\n          if (user.length) {\n            return done(null, user);\n          }\n          return done(null, false);\n        })\n        .catch(err => console.log(err));\n    })\n  );\n};\n"],"mappings":";;AAAA,IAAAA,QAAA,GAAuBC,OAAO,CAAC,cAAc,CAAC;EAAtCC,UAAU,GAAAF,QAAA,CAAVE,UAAU;AAClB,IAAMC,WAAW,GAAGF,OAAO,CAAC,cAAc,CAAC,CAACG,QAAQ;AACpD,IAAMC,MAAM,GAAGJ,OAAO,CAAC,WAAW,CAAC;AACnCA,OAAO,CAAC,QAAQ,CAAC,CAACK,MAAM,CAAC,CAAC;AAE1B,IAAMC,KAAK,GAAGF,MAAM,CAACG,IAAI;AAEzB,IAAMC,IAAI,GAAG,CAAC,CAAC;AACfA,IAAI,CAACC,cAAc,GAAGR,UAAU,CAACS,2BAA2B,CAAC,CAAC;AAC9DF,IAAI,CAACG,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACC,cAAc;AAE7CC,MAAM,CAACC,OAAO,GAAG,UAAAC,QAAQ,EAAI;EAC3BA,QAAQ,CAACC,GAAG,CACV,IAAIhB,WAAW,CAACM,IAAI,EAAE,UAACW,WAAW,EAAEC,IAAI,EAAK;IAC3Cd,KAAK,CAACe,OAAO,CAAC;MAAEC,KAAK,EAAE;QAAEC,EAAE,EAAEJ,WAAW,CAACI;MAAG;IAAE,CAAC,CAAC,CAC7CC,IAAI,CAAC,UAAAC,IAAI,EAAI;MACZ,IAAIA,IAAI,CAACC,MAAM,EAAE;QACf,OAAON,IAAI,CAAC,IAAI,EAAEK,IAAI,CAAC;MACzB;MACA,OAAOL,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC;IAC1B,CAAC,CAAC,SACI,CAAC,UAAAO,GAAG;MAAA,OAAIC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;IAAA,EAAC;EACnC,CAAC,CACH,CAAC;AACH,CAAC","ignoreList":[]}